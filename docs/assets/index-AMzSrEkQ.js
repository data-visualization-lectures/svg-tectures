(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}})();class d{constructor(){this.currentTexture="lines",this.currentFgColor="#1f2937",this.currentBgColor="#ffffff",this.currentSample="bar-chart",this.textureDensity=1,this.textureThickness=1,this.initElements(),this.attachEventListeners(),this.render()}initElements(){this.elements={textureSelect:document.getElementById("texture-select"),fgColor:document.getElementById("fg-color"),bgColor:document.getElementById("bg-color"),fgColorValue:document.getElementById("fg-color-value"),bgColorValue:document.getElementById("bg-color-value"),textureDensity:document.getElementById("texture-density"),densityValue:document.getElementById("density-value"),textureThickness:document.getElementById("texture-thickness"),thicknessValue:document.getElementById("thickness-value"),svgSelect:document.getElementById("svg-select"),applyBtn:document.getElementById("apply-btn"),svgContainer:document.getElementById("svg-container"),codeDisplay:document.getElementById("code-display"),copyCodeBtn:document.getElementById("copy-code-btn"),copyFeedback:document.getElementById("copy-feedback")}}attachEventListeners(){this.elements.textureSelect.addEventListener("change",e=>{this.currentTexture=e.target.value}),this.elements.fgColor.addEventListener("input",e=>{this.currentFgColor=e.target.value,this.elements.fgColorValue.textContent=e.target.value.toUpperCase()}),this.elements.bgColor.addEventListener("input",e=>{this.currentBgColor=e.target.value,this.elements.bgColorValue.textContent=e.target.value.toUpperCase()}),this.elements.textureDensity.addEventListener("input",e=>{this.textureDensity=parseFloat(e.target.value),this.elements.densityValue.textContent=`(${this.textureDensity.toFixed(1)})`}),this.elements.textureThickness.addEventListener("input",e=>{this.textureThickness=parseFloat(e.target.value),this.elements.thicknessValue.textContent=`(${this.textureThickness.toFixed(1)})`}),this.elements.svgSelect.addEventListener("change",e=>{this.currentSample=e.target.value}),this.elements.applyBtn.addEventListener("click",()=>{this.render(),this.updateCode()}),this.elements.copyCodeBtn.addEventListener("click",()=>{this.copyCodeToClipboard()})}createBarChart(){const e=[{label:"Q1",value:65},{label:"Q2",value:78},{label:"Q3",value:45},{label:"Q4",value:88}],t=d3.select(this.elements.svgContainer).selectAll("svg").data([null]).join("svg").attr("width",600).attr("height",400);t.selectAll("*").remove();const s={top:20,right:20,bottom:30,left:60},r=600-s.left-s.right,o=400-s.top-s.bottom,i=t.append("g").attr("transform",`translate(${s.left},${s.top})`),n=d3.scaleBand().domain(e.map(a=>a.label)).range([0,r]).padding(.1),c=d3.scaleLinear().domain([0,100]).range([o,0]);i.selectAll(".bar").data(e).join("rect").attr("class","bar").attr("x",a=>n(a.label)).attr("y",a=>c(a.value)).attr("width",n.bandwidth()).attr("height",a=>o-c(a.value)).attr("fill",this.currentBgColor).attr("stroke",this.currentFgColor).attr("stroke-width",2),i.append("g").attr("transform",`translate(0,${o})`).call(d3.axisBottom(n)).attr("color",this.currentFgColor),i.append("g").call(d3.axisLeft(c)).attr("color",this.currentFgColor),this.applyTextureToElements(t)}createPieChart(){const e=[{label:"A",value:30},{label:"B",value:25},{label:"C",value:20},{label:"D",value:25}],t=d3.select(this.elements.svgContainer).selectAll("svg").data([null]).join("svg").attr("width",500).attr("height",500);t.selectAll("*").remove();const s=150,r=t.append("g").attr("transform","translate(250,250)"),o=d3.pie().value(n=>n.value),i=d3.arc().innerRadius(0).outerRadius(s);r.selectAll(".arc").data(o(e)).join("g").attr("class","arc").append("path").attr("d",i).attr("fill",this.currentBgColor).attr("stroke",this.currentFgColor).attr("stroke-width",2),this.applyTextureToElements(t)}createNetwork(){const e=[{id:0,label:"Node 1"},{id:1,label:"Node 2"},{id:2,label:"Node 3"},{id:3,label:"Node 4"},{id:4,label:"Node 5"}],t=[{source:0,target:1},{source:0,target:2},{source:1,target:3},{source:2,target:3},{source:3,target:4}],s=d3.select(this.elements.svgContainer).selectAll("svg").data([null]).join("svg").attr("width",600).attr("height",500);s.selectAll("*").remove();const r=d3.forceSimulation(e).force("link",d3.forceLink(t).id(n=>n.id).distance(100)).force("charge",d3.forceManyBody().strength(-300)).force("center",d3.forceCenter(300,250)),o=s.selectAll("line").data(t).join("line").attr("stroke",this.currentFgColor).attr("stroke-width",2),i=s.selectAll("circle").data(e).join("circle").attr("r",20).attr("fill",this.currentBgColor).attr("stroke",this.currentFgColor).attr("stroke-width",2);r.on("tick",()=>{o.attr("x1",n=>n.source.x).attr("y1",n=>n.source.y).attr("x2",n=>n.target.x).attr("y2",n=>n.target.y),i.attr("cx",n=>n.x).attr("cy",n=>n.y)}),this.applyTextureToElements(s)}createGrid(){const e=d3.select(this.elements.svgContainer).selectAll("svg").data([null]).join("svg").attr("width",600).attr("height",400);e.selectAll("*").remove();const t=4,s=5,r=600/s,o=400/t;e.selectAll("rect.grid-cell").data(d3.range(t*s)).join("rect").attr("class","grid-cell").attr("x",i=>i%s*r).attr("y",i=>Math.floor(i/s)*o).attr("width",r).attr("height",o).attr("fill",this.currentBgColor).attr("stroke",this.currentFgColor).attr("stroke-width",2),this.applyTextureToElements(e)}applyTextureToElements(e){if(this.currentTexture==="noop")return;let t;try{switch(this.currentTexture){case"lines":t=textures.lines().stroke(this.currentFgColor).background(this.currentBgColor).size(8*this.textureDensity).strokeWidth(1.5*this.textureThickness);break;case"diagonal-stripe":t=textures.lines().orientation("diagonal").stroke(this.currentFgColor).background(this.currentBgColor).size(8*this.textureDensity).strokeWidth(1.5*this.textureThickness);break;case"horizontal-stripe":t=textures.lines().orientation("horizontal").stroke(this.currentFgColor).background(this.currentBgColor).size(8*this.textureDensity).strokeWidth(1.5*this.textureThickness);break;case"vertical-stripe":t=textures.lines().orientation("vertical").stroke(this.currentFgColor).background(this.currentBgColor).size(8*this.textureDensity).strokeWidth(1.5*this.textureThickness);break;case"circles":t=textures.circles().stroke(this.currentFgColor).background(this.currentBgColor).size(12*this.textureDensity).radius(2*this.textureThickness).strokeWidth(1*this.textureThickness);break;case"dots":t=textures.circles().stroke(this.currentFgColor).background(this.currentBgColor).size(10*this.textureDensity).radius(1.5*this.textureThickness).strokeWidth(.5*this.textureThickness).complement();break;case"cross-hatch":t=textures.paths().d("crosses").stroke(this.currentFgColor).background(this.currentBgColor).size(8*this.textureDensity).strokeWidth(1*this.textureThickness);break;case"squares":t=textures.paths().d("squares").stroke(this.currentFgColor).fill(this.currentBgColor).background(this.currentBgColor).size(10*this.textureDensity).strokeWidth(1*this.textureThickness);break;case"hexagons":t=textures.paths().d("hexagons").stroke(this.currentFgColor).background(this.currentBgColor).size(12*this.textureDensity).strokeWidth(1.5*this.textureThickness);break;case"woven":t=textures.paths().d("woven").stroke(this.currentFgColor).background(this.currentBgColor).size(10*this.textureDensity).strokeWidth(1*this.textureThickness);break;case"waves":t=textures.paths().d("waves").stroke(this.currentFgColor).background(this.currentBgColor).size(12*this.textureDensity).strokeWidth(1.5*this.textureThickness);break;case"caps":t=textures.paths().d("caps").stroke(this.currentFgColor).background(this.currentBgColor).size(10*this.textureDensity).strokeWidth(1*this.textureThickness);break;case"nylon":t=textures.paths().d("nylon").stroke(this.currentFgColor).background(this.currentBgColor).size(12*this.textureDensity).strokeWidth(1.5*this.textureThickness);break;default:return}e.call(t),e.selectAll('rect.bar, rect.grid-cell, circle, path:not([role="link"])').style("fill",t.url())}catch(s){console.warn("Texture application note:",this.currentTexture,s.message)}}adjustColor(e,t){const s=parseInt(e.replace("#",""),16),r=Math.round(2.55*t),o=Math.max(0,Math.min(255,(s>>16)+r)),i=Math.max(0,Math.min(255,(s>>8&255)+r)),n=Math.max(0,Math.min(255,(s&255)+r));return"#"+(16777216+o*65536+i*256+n).toString(16).slice(1)}render(){const e=this.elements.svgContainer;switch(e.innerHTML="",this.currentSample){case"bar-chart":this.createBarChart();break;case"pie-chart":this.createPieChart();break;case"network":this.createNetwork();break;case"grid":this.createGrid();break;default:this.createBarChart()}this.updateCode()}generateCodeSnippet(){const e=this.textureDensity,t=this.textureThickness,s=this.currentFgColor,r=this.currentBgColor;let o="";if(this.currentTexture==="noop")o="// テクスチャなし";else if(["lines","diagonal-stripe","horizontal-stripe","vertical-stripe"].includes(this.currentTexture)){let n="diagonal";this.currentTexture==="horizontal-stripe"&&(n="horizontal"),this.currentTexture==="vertical-stripe"&&(n="vertical"),o=`const tx = textures.lines()
    .stroke('${s}')
    .background('${r}')
    .size(${8*e})
    .strokeWidth(${1.5*t});`,this.currentTexture!=="lines"&&(o=`const tx = textures.lines()
    .orientation('${n}')
    .stroke('${s}')
    .background('${r}')
    .size(${8*e})
    .strokeWidth(${1.5*t});`)}else if(this.currentTexture==="circles")o=`const tx = textures.circles()
    .stroke('${s}')
    .background('${r}')
    .size(${12*e})
    .radius(${2*t})
    .strokeWidth(${1*t});`;else if(this.currentTexture==="dots")o=`const tx = textures.circles()
    .stroke('${s}')
    .background('${r}')
    .size(${10*e})
    .radius(${1.5*t})
    .strokeWidth(${.5*t})
    .complement();`;else if(["cross-hatch","squares","hexagons","woven","waves","caps","nylon"].includes(this.currentTexture)){const c={"cross-hatch":"crosses",squares:"squares",hexagons:"hexagons",woven:"woven",waves:"waves",caps:"caps",nylon:"nylon"}[this.currentTexture],a={"cross-hatch":8,squares:10,hexagons:12,woven:10,waves:12,caps:10,nylon:12}[this.currentTexture],u={"cross-hatch":1,squares:1,hexagons:1.5,woven:1,waves:1.5,caps:1,nylon:1.5}[this.currentTexture];this.currentTexture==="squares"?o=`const tx = textures.paths()
    .d('${c}')
    .stroke('${s}')
    .fill('${r}')
    .background('${r}')
    .size(${a*e})
    .strokeWidth(${u*t});`:o=`const tx = textures.paths()
    .d('${c}')
    .stroke('${s}')
    .background('${r}')
    .size(${a*e})
    .strokeWidth(${u*t});`}return`// SVG Texture Editor で生成されたコード
// Textures.js: https://riccardoscalco.it/textures/

// テクスチャの設定
${o}

// SVGに適用
svg.call(tx);

// 塗りつぶし要素にテクスチャを適用
svg.selectAll('rect, circle, path')
    .style('fill', tx.url());`}updateCode(){const e=this.generateCodeSnippet();this.elements.codeDisplay.textContent=e}copyCodeToClipboard(){const e=this.elements.codeDisplay.textContent;navigator.clipboard.writeText(e).then(()=>{this.elements.copyFeedback.classList.remove("hidden"),setTimeout(()=>{this.elements.copyFeedback.classList.add("hidden")},2e3)}).catch(t=>{console.error("コピーに失敗しました:",t)})}}function l(){if(typeof d3>"u"){console.warn("Waiting for D3.js to load..."),setTimeout(l,100);return}if(typeof textures>"u"){console.warn("Waiting for Textures.js to load..."),setTimeout(l,100);return}new d}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",l):l();
